# Reading and Writing Files

## Reading Files
When we open a file, OS checks whether we have permissions to access that file and then gives our code a `file descriptor`.

- **File Descriptor:** A token, generated by OS, that allows programs to do more operations with the file. In python this file descriptor is stored as an attribute of the files object. The file gives us a bunch of methods to operate with the file.
- In Python, this file descriptor is stored as an attribute of the file object. The file object gives us a bunch of methods that we can use to operate with the file.
- Each time we can any read method using our file desciptor, the file object updates the current position in the file.
- Each read method, starts reading from current position in the file. 
- `Read-only` is the default mode when opening a file.

**Other Modes:** <br>
    - **'a'** : Append
    - **'r+'**: Read-Write Mode


```python
# read :- read the entire file into a str
# readline :- read the entire line into a str
# readlines :- read the entire file into a list
```
## Iterating Files
```python
# strip() :- It is helpful in removing the newline character, tab at the end of a line

## code snippet will correctly open a file and print lines one by one without whitespace?
with open("hello_world.txt") as text:
    for line in text:
	    print(line.strip())
```
**NOTE**: Method like `read` and `readlines` that read the whole file are useful. But we should be careful when reading the entire contents of a file into a variable of our program.

## Writing Files
```python
# write() :- write Contents to the file, when successful, it returns the number of characters written by `write` method.
with open("novel.txt", "w") as fh:
    fh.write("I am a good son")

# When write method is successful, it returns the number of characters it wrote inside the file
```
**NOTE**: If you open a file for writing and file already exists, the old contents will be deleted as soon as the file is opened.

### Reading and Writing Files Cheat-Sheet
- Check out the following link for more information:
    - https://docs.python.org/3/library/functions.html#open

## Working with files and directories
- **os.path** :- submodule to check various options like file exists , dir exists or not etc
```python
# os module common functions:
    # os.remove(filename)                   # removes the file if exist else raise FileNotFoundError
    # os.rename("old_name", new_name")      # if exist else raise FileNotFoundError

    # os.path :- submodule to check various options like file exists , dir exists or not etc
            # os.path.exists(path)          # check whether a file exists or not. Returns True or False
    # os.path.getsize()                     # returns the size of file in bytes
    # os.path.getmtime()                    # returns the timestamp of the last modified
    # os.path.isfile(filepath)              # returns is the file exists or not
    # os.path.abspath(file)                 # returns the absolute path of the file

    # os.getcwd()                           # returns the current working directory
    # os.mkdir()                            # create a directory
    # os.chdir(new_dir_path)                # cd into the new_dir
    # os.rmdir(dir_name)                    # remove empty directory
    # os.listdir(dir_name)                  # list all the contents in a directory
    # os.path.isdir(path)                   # returns True/False
    # os.path.join(path1, path2 ...)        # joins and returns the combined path
```
```python
def last_modified(filename):
    import os
    import datetime
    timestamp = os.path.getmtime(filename)  
    return datetime.datetime.fromtimestamp(timestamp)
```
### **Files and Directories Cheat-Sheet**
- https://docs.python.org/3/library/os.html
- https://docs.python.org/3/library/os.path.html
- https://en.wikipedia.org/wiki/Unix_time

## Reading and Writing CSV Files
- **HTML :** It is a markup format which defines the content of a webpage.
- **JSON :** Is is a data interchange format commonly used to pass data between computers on networks especially the internet.

### Reading the CSV Files
```python
import csv
with open("csv_file.txt") as fh:
    csv_f = csv.reader(fh)
    # row variable is a list containing per row data
    for row in csv_f:
        print(row)
```

### Writing into CSV Files
```python
# writerow              It writes one row at a time
# writerows             It will write all the rows together

hosts = [["anuragmodi", "192.168.25.46"], ["akashjain", "192.168.45.12"]]
with open("csv_file.txt", "w") as fh:
    writer = csv.writer(fh)
    writer.writerows(hosts) 
```

### Reading and Writing CSV Files with Dictionaries
**DictReader :** It turns each row of the data in a CSV file into a dictionary. We can then access the data by using the column names instead of the position in the row.
```python
with open("csv_file") as fh:
    reader = csv.DictReader(fh)
    # row variable is a dict containing per row data
    for row in reader:
        print(row)

# DictWriter
keys = ["name", "username", "department"]
users = [
    {"name": "anurag", "username" : "anuragmodi", "department" : "it"}, 
    {"name": "akash", "username" : "akashjain", "department" : "it"}, 
    ]
with open("csv_file", "w") as fh:
    writer = csv.DictWriter(fh, fieldnames=keys)
    writer.writeheader()
    writer.writerows(users)
```

## CSV Files Cheat Sheet
- https://docs.python.org/3/library/csv.html
- https://realpython.com/python-csv/

# Graded Assignment
**DictReader:** DictReader creates an object that operates like a regular reader (an object that iterates over lines in the given CSV file), but also maps the information it reads into a dictionary where keys are given by the optional fieldnames parameter. If we omit the fieldnames parameter, the values in the first row of the CSV file will be used as the keys. So, in this case, the first line of the CSV file has the keys and so there's no need to pass fieldnames as a parameter. <br>
We also need to pass a dialect as a parameter to this function. There isn't a well-defined standard for comma-separated value files, so the parser needs to be flexible. Flexibility here means that there are many parameters to control how csv parses or writes data. Rather than passing each of these parameters to the reader and writer separately, we group them together conveniently into a dialect object. <br>
Dialect classes can be registered by name so that callers of the CSV module don't need to know the parameter settings in advance. We will now register a dialect empDialect.
```python
csv.register_dialect('empDialect', skipinitialspace=True, strict=True)
with open("csv_file") as fh:
    reader = csv.DictReader(fh, dialect="empDialect")
    # row variable is a dict containing per row data
    for row in reader:
        print(row)
```
**sort(dictionary):** Default behavior of calling sort function on dictionary means, the data will be sorted based on keys of the dictionary.
